[:page name="studentView" args="String errorDescription, dynamic timetableRow, dynamic averages,
String lastRefresh,
String lastMailInfo, String urgentAbsence, String urgentHomeworks"]
[:include "/webapp/view/templates/head.html" /]
[:dart]
String nbsp = "\u{00A0}";
[/dart]
<div class="content">
    [:if errorDescription != null]
    <aside class="errorBar">
        <p>
            [= errorDescription]
        </p>
    </aside>
    [/if]
    <noscript>
        <aside class="errorBar">
            <p>
                Nemáte zapnutý JavaScript, stránka tedy sama nenačítá
                přijaté informace. Můžete je načíst manuálně obnovením
                stránky (<span style="background-color: lightgray">F5</span>)
            </p>
        </aside>
    </noscript>
    <div id="failed-to-fetch-update" style="display: none">
        <aside class="errorBar">
            <p>
                Připojení k serveru školy proběhlo úspěšně, ale něco
                se nepodařilo načíst. Na této stránce se zobrazí vše,
                co se nám podařilo načíst. Pokud tento stav přetrvává,
                <a href="/contact">kontaktujte vývojáře</a>.
            </p>
        </aside>
    </div>
    <div class="pure-g" id="main">
        <div class="pure-u-1 pure-u-md-1" id="rozvrh">
            <h1 class="content-subhead">Rozvrh</h1>
            [:if timetableRow == null]
            <p class="loader">
                Načítám rozvrh, za chvíli tady bude...
            </p>
            [:else]
            [/if]
        </div>
        <div class="pure-u-1 pure-u-md-1-2" id="znamky">
            <h1 class="content-subhead">Průměry</h1>
            [:if averages == null]
            <p class="loader">
                Načítám známky, za chvíli to bude...
            </p>
            [:else]
            <table class="pure-table">
                <tbody>
                    [:for subject in averages.keys]
                    <tr>
                        <td>
                            <a href="/student/subject/[= subject]">[= subject]</a>
                        </td>
                        <td>
                            [= averages[subject].toStringAsPrecision(3)]
                        </td>
                    </tr>
                    [/for]
                </tbody>
            </table>
            [/if]
        </div>
        <div class="pure-u-1 pure-u-md-1-2" id="otherModules">
            <h1 class="content-subhead">Ostatní moduly</h1>
            <ul>
                <li>
                    <a href="/student/grade">Přehled všech známek</a>
                </li>
                <li>
                    <a href="/student/message">Přehled zpráv</a>
                    [= lastMailInfo == null ? '' : '(poslední zpráva $lastMailInfo)' ]
                </li>
                <li>
                    <a href="/student/absention">Přehled absencí</a>
                    [= urgentAbsence == null ? '' : urgentAbsence]
                </li>
                <li>
                    <a href="/student/homework">Přehled domácích úkolů</a>
                    [= urgentHomeworks == null ? '' : urgentHomeworks ]
                </li>
                <li>
                    <a href="/student/subject">Přehled předmětů</a>
                </li>
            </ul>
        </div>
    </div>
</div>
[:if lastRefresh != null]
<p style="text-align: center">
    To co vidíte na této stránce je [= lastRefresh] staré.
    <a href="/refresh"><button class="pure-button">Obnovit</button></a>
</p>
[/if]

<script>
    if ('serviceWorker' in navigator) {
        navigator.serviceWorker
            .register('/offlineServiceWorker.js')
            .then(function () { console.log("Service Worker Registered"); });
    }
</script>
<script src="../../js/buttonSwitch.js"></script>
<script src="../../js/studentRefresh.js"></script>
[:include "/webapp/view/templates/tail.html" /]